# 概述

Omi-Stack 是一款遵循 RESTful 规范的接口层框架。

在过去的 Web 应用中，前后端的服务有明显的上下游关系，为了不让后端的开发进度阻塞前端的进展，在 Web 开发的早期，服务端通常会使用 Swagger 作为文档工具来和前端同步接口信息。

随着互联网时代的发展，IDL 这个概念逐渐走进了人们的视野，以 Thrift 和 Protobuf 为代表的一众结构化的接口描述语言慢慢拥有了一定的地位，相比于 Swagger（Open Api）所采用的 JSON、YAML，它们可以用更简练的信息对接口进行描述，从而降低前后端之间的接口通信成本。

但很令人感到遗憾的是，Thrift 和 gRPC 几乎都是为 RPC 通信而生的，它们对于中小型应用里更常用到的 RESTful 风格接口的支持力度几近于无，为了填补这个缺口，我就开发了这么个框架来降低中小型 Web 项目中的通信成本。

# 架构

Omi-Stack 主要的功能分为下面几个部分：

- Omi-IDL-Extension（独立仓库）

  Omi IDL 文件的 Vscode 扩展，旨在为 IDL 文件提供最基础的代码高亮和错误诊断。

- Omi-ast-parser

  IDL 文件的 Parser，用来生成语法树，供 Codegen 和代码高亮使用。

- Omi-client

  对 Axios 进行了一层封装，抽象出了 RESTful 风格请求中可复用的部分。通过 Omi-Codegen 生成的代码需调用这个库才能正常发起请求。

- Omi-server

  对 KOA 的一层浅封装，目的是在用户态屏蔽掉 URL 的声明，同时允许用户以接近 Nest.js 的风格来编写 Controller 层的代码

- Omi-Codegen

  代码生成工具，可以根据 IDL 文件的内容生成客户端的请求类或服务端的接口类，免去了手动维护 Url 的麻烦。

# 示例

TODO 应用：https://github.com/sheason2019/omi-example
